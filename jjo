#!/bin/sh
unset SESSION_MANAGER
unset DBUS_SESSION_BUS_ADDRESS

# --- Nastavení input method ---
export GTK_IM_MODULE=ibus
export QT_IM_MODULE=ibus
export XMODIFIERS=@im=ibus

# --- Spustit ibus, pokud neběží ---
if ! pgrep -u "$USER" -x ibus-daemon >/dev/null 2>&1; then
    nohup ibus-daemon --daemonize --xim >/dev/null 2>&1 &
fi

# --- Spustit dbus session ---
if [ -z "$DBUS_SESSION_BUS_ADDRESS" ]; then
    eval `dbus-launch --sh-syntax --exit-with-session`
fi

# --- Spustit LXDE ---
exec startlxde
