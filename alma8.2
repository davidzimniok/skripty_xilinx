# 1. Zastavit všechno
pkill filebrowser

# 2. Smazat vše a začít znovu
rm -rf /etc/filebrowser
mkdir -p /etc/filebrowser
cd /etc/filebrowser

# 3. Inicializace databáze
filebrowser config init

# 4. Základní konfigurace (bez --database, používá default .filebrowser.json)
filebrowser config set --address 0.0.0.0
filebrowser config set --port 8080
filebrowser config set --root /home

# 5. Přidat admin
filebrowser users add admin admin123 --perm.admin

# 6. Přidat studenta pro test
filebrowser users add u01 1 --scope /home/u01

# 7. Kontrola uživatelů
filebrowser users ls

# 8. Spustit
filebrowser &

# 1. Nejdřív zkontroluj že filebrowser běží
ps aux | grep filebrowser

# 2. Přidání studentů do databáze
DB="/etc/filebrowser/filebrowser.db"

for i in $(seq -w 1 20); do
    USERNAME="u$i"
    PASSWORD="$i" 
    HOMEDIR="/home/$USERNAME"
    
    filebrowser users add "$USERNAME" "$PASSWORD" \
        --scope "$HOMEDIR" \
        --perm.create \
        --perm.delete \
        --perm.download \
        --perm.modify \
        --perm.rename \
        --perm.upload \
        --database "$DB"
    
    echo "Přidán: $USERNAME (heslo: $PASSWORD)"
done

# 3. Kontrola přidaných uživatelů
filebrowser users ls --database "$DB"

# Učitelé s plným přístupem
TEACHERS=("zim" "micha" "pau")
for teacher in "${TEACHERS[@]}"; do
    filebrowser users add "$teacher" "Agent007" \
        --scope "/home" \
        --perm.admin \
        --database "$DB"
    echo "Přidán učitel: $teacher"
done
